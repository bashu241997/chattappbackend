{"version":3,"file":"index.js","names":["express","require","http","socketio","adduser","removeuser","getuser","getusersinroom","endpoint","app","server","createServer","io","router","Router","use","req","res","next","header","get","send","status","on","socket","name","room","callback","error","user","id","join","emit","text","broadcast","to","users","message","listen","process","env","PORT","console","log"],"sources":["../src/index.js"],"sourcesContent":["const express = require('express')\r\nconst http = require('http')\r\nconst  socketio = require('socket.io')\r\nconst {adduser,removeuser,getuser,getusersinroom} = require('./users')\r\n\r\nconst endpoint =5000;\r\nconst app = express();\r\nconst server = http.createServer(app);\r\nconst io = socketio(server);\r\nconst router = express.Router();\r\n\r\napp.use((req, res, next)=> {\r\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\r\n  next();\r\n});\r\nrouter.get(\"/\", (req, res) => {\r\n  res.send( \"sET \").status(200);\r\n});\r\napp.use(router);\r\n\r\n//socket connection \r\nio.on('connect', (socket) => {\r\n  socket.on('join', ({ name, room }, callback) => {\r\n    const { error, user } = adduser({ id: socket.id, name, room });\r\n\r\n    if(error) return callback(error);\r\n\r\n    socket.join(user.room);\r\n\r\n    socket.emit('message', { user: 'admin', text: `${user.name}, welcome to group`});\r\n    socket.broadcast.to(user.room).emit('message', { user: 'admin', text: `${user.name} has joined..!` });\r\n\r\n    io.to(user.room).emit('roomData', { room: user.room, users: getusersinroom(user.room) });\r\n\r\n    callback();\r\n  });\r\n\r\n  socket.on('sendMessage', (message, callback) => {\r\n    const user = getuser(socket.id);\r\n\r\n    io.to(user.room).emit('message', { user: user.name, text: message });\r\n\r\n    callback();\r\n  });\r\n\r\n  socket.on('disconnect', () => {\r\n    const user = removeuser(socket.id);\r\n\r\n    if(user) {\r\n      io.to(user.room).emit('message', { user: 'admin', text: `${user.name} has left.` });\r\n      io.to(user.room).emit('roomData', { room: user.room, users: getusersinroom(user.room)});\r\n    }\r\n  })\r\n});;\r\n\r\nserver.listen(process.env.PORT || endpoint,()=> console.log(`server runnin ${endpoint}`));"],"mappings":"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"}